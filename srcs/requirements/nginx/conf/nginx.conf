worker_processes auto;

events {}

http {
    sendfile on;

    server {
        listen 443 ssl http2;
        listen [::]:443 ssl http2;

        server_name ${DOMAIN_NAME};
		ssl_certificate /etc/ssl/certs/nginx-selfsigned.crt;
        ssl_certificate_key /etc/ssl/private/nginx-selfsigned.key;
        
        root /var/www/html;
        ## This should be in your http block and if it is, it's not needed here.
        index index.php;
		location / {
		# This is cool because no php is touched for static content.
		# include the "?$args" part so non-default permalinks doesn't break when using query string
			try_files $uri $uri/ /index.php?$args;
        }

		location ~ \.php$ {
			#NOTE: You should have "cgi.fix_pathinfo = 0;" in php.ini
			include fastcgi_params;
			fastcgi_intercept_errors on;
			fastcgi_pass php-fpm;
			#The following parameter can be also included in fastcgi_params file
			fastcgi_param  SCRIPT_FILENAME $document_root$fastcgi_script_name;
		}
    }

	# Upstream to abstract backend connection(s) for php
	upstream php-fpm {
			server wordpress:9000;
	}
}

